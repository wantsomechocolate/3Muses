{{extend 'layout.html'}}

<!--The Payment Container-->

{{ payment_method = session.payment_method }}
{{ print payment_method}}

<div class="container-fluid style2">

	<div class='container'>

		<!-- This holds the card options -->
		<div class='row'> 

			<div class="col-md-offset-2 col-md-8 checkout-view-payment-group-container">

				<h2 class="checkout-view-payment-group-header">Pay With Card</h2>






<h1> What the actual fuck </h1>

<form enctype="multipart/form-data" action="{{=URL('pay_stripe')}}" method="post">
  
  <label>Your name:</label>
  <input name="name" />

  {{ import os }}
  <script
    src="https://checkout.stripe.com/checkout.js" class="stripe-button"
    data-key="{{=os.environ['STRIPE_PUBLISHABLE']}}"
    data-amount={{ =session.total_cost_USC }}
    data-name="ThreeMusesGlass"
    data-description="Purchase Details from ThreeMusesGlass"
    data-bitcoin="true"
    data-label="Pay with Stripe"
    data-panel-label="What is this?"
    data-zip-code='true'
    data-image="http://images.clipartpanda.com/smiley-face-png-1407-smiley-face.png">
  </script>


</form>







				
				<hr class="checkout-view-hr">

				<div class="align-hcenter cart-view-card-container">

				{{ if card_information['error']: }}

					<div class="cart-view-error-text-container">
						{{ =card_information['error_message'] }}
					</div>

				{{ else: }}

					{{ for i in range(len(card_information['card_information_LOD'])): }}

					{{ payment_id = card_information['card_information_LOD'][i]['card_id']}}

					{{print "payment_method"}}
					{{print payment_method}}
					{{print "payment_id"}}
					{{print payment_id}}

					{{ selected_class = "cart-view-payment-option-selected" if payment_method == payment_id else "" }}

					{{ print selected_class }}


					<!-- This hold the card and the popover with controls -->
					<div>
						<div id= "{{ =payment_id }}" class="col-md-offset-3 col-md-6 cart-view-payment-card-container cart-view-payment-option {{ =selected_class }} ">

							<div class="cart-view-payment-card-cardnumber">
								XXXX-XXXX-XXXX-{{ =card_information['card_information_LOD'][i]['card_last4'] }}
							</div>

							<div class="cart-view-payment-card-expiration">
								{{ =card_information['card_information_LOD'][i]['card_exp_mo'] }} /
								{{ =card_information['card_information_LOD'][i]['card_exp_yr'] }}
							</div>

							<div class="col-xs-6 cart-view-payment-card-cardname">
								{{ =card_information['card_information_LOD'][i]['card_name'] }}
							</div>

							<div class="cart-view-payment-card-cardbrand">
								{{ =card_information['card_information_LOD'][i]['card_brand'] }}
							</div>

						</div> <!--Close cart-view-payment-card-container-->


						<div class="col-xs-offset-6 col-xs-6 col-md-offset-7 col-md-2 cart-view-payment-card-controls-container">


							<button type="button" 
								class="btn btn-default cart-view-card-controls-popover" 
								data-container="body" 
								data-toggle="popover" 
								data-placement="left" 
								data-trigger="focus" 
								data-html="true" 
								data-content="<div class='cart-view-payment-card-carddelete'>
									{{ =card_information['card_information_LOD'][i]['card_delete'].xml() }}
									</div>">

								<span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>

							</button>

						</div>

					</div>

					<br/>
					<br/>

					{{ pass }}

				{{ pass }}

				</div>

				<hr class="checkout-view-hr">

				<div class="align-right cart-view-btn-container">
					<form action="{{=URL('default','add_new_card')}}">
					    <input type="submit" value="Add New Card" class="btn btn-info cart-view-btn">
					</form>
				</div>

			<!-- Close offset div -->
			</div> 

		<!-- Close row -->
		</div>



		<br/>
		<br/>



		<!-- This holds the other payment options -->
		<div class='row'> 

			<div class="col-md-offset-2 col-md-8 checkout-view-payment-group-container">

				<h2 class="checkout-view-payment-group-header">Other Payment Options</h2>
				<hr class="checkout-view-hr">

				<div class="cart_payment_sub_options_container">

					{{ payment_id = "paypal"}}

					{{ selected_class = "cart-view-payment-option-selected" if payment_method == payment_id else "" }}
					<div id="paypal" class="align-hcenter col-md-offset-3 col-md-6 cart-view-payment-paypal-container cart-view-payment-option {{ =selected_class }} ">

						<div>
							<!-- Paypal -->
							<img src="https://www.paypalobjects.com/webstatic/en_US/i/buttons/checkout-logo-large.png" alt="Check out with PayPal" />
						</div>



					</div>


<!-- 					{-{ payment_id = "bitcoin"}-}

					{-{ selected_class = "cart-view-payment-option-selected" if payment_method == payment_id else "" }-}

					<div id="Bitcoin" class="align-hcenter col-md-offset-3 col-md-6 cart-view-payment-bitcoin-container cart-view-payment-option {-{ =selected_class }-} ">

						<div>
							Bitcoin
						</div>
						
					</div> -->

				</div>

				<hr class="checkout-view-hr">
				<br/>


			<!-- Close ofset div -->
		    </div>

		<!-- Close row -->
		</div>

	<!-- Close container -->
	</div>

<!-- Close Fluid Container -->
</div>






<div class="container-fliud style1">
	<div class='container'>
		<div class="row">
			<div class="col-md-3 col-md-offset-7 align-right">
				<!--<a class="btn btn-sucess" href=" cbcb =URL('checkout') cbcb ">Checkout</a>-->
				<form action="{{=URL('review')}}">
				    <input type="submit" value="Review Order Details" class="btn btn-success cart-view-btn">
				</form>
			</div>
		</div>
	</div>
</div>

